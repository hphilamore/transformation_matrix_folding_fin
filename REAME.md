
# A model of the fin folding kinematics. 

- The profile of each fin ray was represented as an isosceles triangle with the smallest angle $\alpha$ and the shortest side length $a$. 

- Each hinge, $i$ was represented as a revolute joint, $q_i$. 

- The axis of rotation of each joint $q_i$ is aligned with the rotation axis of hinge $i$, and the position of $q_i$ is on the fin edge, distal to the fin base, $b$. 

- The joints $q$, are connected in series by rigid links of length $a$. 

- The $z$ axis of the base reference frame is aligned with the axis of rotation of $q_i$, and the $x$ axis is parallel to the face of the fin ray connecting hinges $q_i$ and $q_{i+1}$. 

A 3D homogeneous transformation matrix $A^i_{i+1}$, is used to compute the position and orientation of $q_{i+1}$ with respect to the previous hinge $q_i$, denoted by a three-vector $\mathbf{p}^i_{i+1}$ (coordinates $q_{i+1}$ with respect to $q_{i}$) and a 3 Ã— 3 rotation matrix $R^i_{i+1}$. 

The transformation matrix $A^i_{i+1}$ is the product of four basic transformations: First, $R_y(\beta)$ rotates the coordinate axes $x,z$ by angle $\beta= \frac{\alpha}{2}$; then $Tx(a)$ then translates axes $x', z'$ by length $a$; next $R_y(\gamma)$ rotates coordinate axes $x'',z''$ by angle $\gamma= \frac{\alpha}{2}$; finally $R_z(\theta)$ rotates coordinate axes $x''',y'''$ about $z'''$ by joint angle $\theta$. 

$$
R_x(\phi_i) =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & \cos\phi_i & -\sin\phi_i & 0 \\
0 & \sin\phi_i & \cos\phi_i & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

$$
R_y(\gamma_i) =
\begin{bmatrix}
\cos\gamma_i & 0 & \sin\gamma_i & 0 \\
0 & 1 & 0 & 0 \\
-\sin\gamma_i & 0 & \cos\gamma_i & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

$$
R_z(\theta_i) =
\begin{bmatrix}
\cos\theta_i & -\sin\theta_i & 0 & 0 \\
\sin\theta_i & \cos\theta_i & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

$$
T_x(a_i) =
\begin{bmatrix}
1 & 0 & 0 & a_i \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

$$
T_y(c_i) =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & c_i \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

$$
T_z(d_i) =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & d_i \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

$$
\begin{aligned}
A^i_{i+1} &= R_{y}(\beta)\, T_{x}(a)\, R_{y}(\gamma)\, R_{z}(\theta) \\
&= 
\begin{bmatrix}
R^i_{i+1} & \mathbf{p}^i_{i+1} \\
0 & 1
\end{bmatrix} \\
&=
\begin{bmatrix}
\cos\theta\,\cos(\beta+\gamma) & -\sin\theta\,\cos(\beta+\gamma) & \sin(\beta+\gamma) & a\cos\beta \\
\sin\theta & \cos\theta & 0 & 0 \\
-\cos\theta\,\sin(\beta+\gamma) & \sin\theta\,\sin(\beta+\gamma) & \cos(\beta+\gamma) & -a\sin\beta \\
0 & 0 & 0 & 1
\end{bmatrix}
\end{aligned}
$$


It follows that the position and orientation of any hinge $j$, with respect to hinge $$i$$ can be found by $$A^i_{j} = A^i_{i+1} A^{i+1}_{i+2}...A^{j-2}_{j-1} A^{i-1}_{j}$$

A wireframe model of the folded fin was generated by drawing each hinge, to connects each joint $q$, to the fin base, $FB$ where the position (3D coordinates) of $FB$ are the a three-vector $$\mathbf{p}^i_{fb}$$ found by:

$$
\begin{aligned}
FB_i &= A^i-1_{i} T_z(l) \\
&= 
\begin{bmatrix}
R^i_{fb} & \mathbf{p}^i_{fb} \\
0 & 1
\end{bmatrix} 
\end{aligned}
$$
where $l$ is the length of the hinge












 
